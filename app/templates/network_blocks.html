<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Network Blocks - Hadal</title>
    <link rel="stylesheet" href="{{ url_for('static', path='/css/stacks.min.css') }}">
    <script src="{{ url_for('static', path='/js/stacks.min.js') }}"></script>
</head>
<body class="theme-dark p16">
    <main>
        <!-- Navigation -->
        <nav class="s-breadcrumbs mb16">
            <a href="/" class="s-breadcrumbs--item">Home</a>
            <span class="s-breadcrumbs--item s-breadcrumbs--item__current">Network Blocks</span>
        </nav>

        <!-- Header -->
        <div class="d-flex ai-center jc-space-between mb24">
            <h1 class="fs-headline1">Network Blocks</h1>
            <a href="/search" class="s-btn s-btn__primary">Search Responses</a>
        </div>

        <!-- Statistics Cards -->
        <div class="grid g16 mb24">
            <div class="grid--cell s-card">
                <div class="s-card--body">
                    <div class="d-flex ai-center jc-space-between">
                        <div>
                            <div class="s-text-caption s-text-muted">Total Blocks</div>
                            <div class="fs-title">{{ statistics.total_blocks }}</div>
                        </div>
                        <div class="s-badge s-badge__outlined s-badge__gold">
                            <svg class="svg-icon iconDatabase" width="16" height="16" viewBox="0 0 16 16">
                                <path d="M8 1C4.5 1 1 2.5 1 4.5v7C1 13.5 4.5 15 8 15s7-1.5 7-3.5v-7C15 2.5 11.5 1 8 1zM8 2.5c3.5 0 6 1.5 6 2.5s-2.5 2.5-6 2.5S2 6.5 2 5s2.5-2.5 6-2.5zM2 6.5c0 1 2.5 2.5 6 2.5s6-1.5 6-2.5v2c0 1-2.5 2.5-6 2.5s-6-1.5-6-2.5v-2z"/>
                            </svg>
                        </div>
                    </div>
                </div>
            </div>

            <div class="grid--cell s-card">
                <div class="s-card--body">
                    <div class="d-flex ai-center jc-space-between">
                        <div>
                            <div class="s-text-caption s-text-muted">Completed</div>
                            <div class="fs-title">{{ statistics.completed_blocks }}</div>
                        </div>
                        <div class="s-badge s-badge__success">
                            <svg class="svg-icon iconCheckmark" width="16" height="16" viewBox="0 0 16 16">
                                <path d="M13.5 4.5 6 12 2.5 8.5"/>
                            </svg>
                        </div>
                    </div>
                </div>
            </div>

            <div class="grid--cell s-card">
                <div class="s-card--body">
                    <div class="d-flex ai-center jc-space-between">
                        <div>
                            <div class="s-text-caption s-text-muted">Pending</div>
                            <div class="fs-title">{{ statistics.pending_blocks }}</div>
                        </div>
                        <div class="s-badge s-badge__warning">
                            <svg class="svg-icon iconClock" width="16" height="16" viewBox="0 0 16 16">
                                <path d="M8 1C4.5 1 1 4.5 1 8s3.5 7 7 7 7-3.5 7-7-3.5-7-7-7zM8 3v5l3.5 2"/>
                            </svg>
                        </div>
                    </div>
                </div>
            </div>

            <div class="grid--cell s-card">
                <div class="s-card--body">
                    <div class="d-flex ai-center jc-space-between">
                        <div>
                            <div class="s-text-caption s-text-muted">In Progress</div>
                            <div class="fs-title">{{ statistics.in_progress_blocks }}</div>
                        </div>
                        <div class="s-badge s-badge__info">
                            <svg class="svg-icon iconSync" width="16" height="16" viewBox="0 0 16 16">
                                <path d="M8 1v2a6 6 0 0 0-6 6H1a7 7 0 0 1 7-7zM8 15v-2a6 6 0 0 0 6-6h1a7 7 0 0 1-7 7z"/>
                            </svg>
                        </div>
                    </div>
                </div>
            </div>

            <div class="grid--cell s-card">
                <div class="s-card--body">
                    <div class="d-flex ai-center jc-space-between">
                        <div>
                            <div class="s-text-caption s-text-muted">Failed</div>
                            <div class="fs-title">{{ statistics.failed_blocks }}</div>
                        </div>
                        <div class="s-badge s-badge__danger">
                            <svg class="svg-icon iconAlert" width="16" height="16" viewBox="0 0 16 16">
                                <path d="M8 1 1 15h14L8 1zM8 6v4h1V6H8zM9 12H7v1h2v-1z"/>
                            </svg>
                        </div>
                    </div>
                </div>
            </div>

            <div class="grid--cell s-card">
                <div class="s-card--body">
                    <div class="d-flex ai-center jc-space-between">
                        <div>
                            <div class="s-text-caption s-text-muted">Avg Processing Time</div>
                            <div class="fs-title">{{ statistics.avg_processing_hours }}h</div>
                        </div>
                        <div class="s-badge s-badge__outlined s-badge__gold">
                            <svg class="svg-icon iconTimer" width="16" height="16" viewBox="0 0 16 16">
                                <path d="M8 1C4.5 1 1 4.5 1 8s3.5 7 7 7 7-3.5 7-7-3.5-7-7-7zM8 3v5l3.5 2"/>
                            </svg>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Currently Processing Blocks -->
        <div class="s-card">
            <div class="s-card--header">
                <h2 class="s-card--title">
                    Currently Processing Blocks
                    <span class="s-badge s-badge__gold">{{ pagination.total_count }} total</span>
                </h2>
            </div>
            <div class="s-card--body">
                {% if blocks %}
                <div class="s-table-container">
                    <table class="s-table">
                        <thead>
                            <tr>
                                <th scope="col">ID</th>
                                <th scope="col">Network</th>
                                <th scope="col">Status</th>
                                <th scope="col">Assigned To</th>
                                <th scope="col">Last Assigned</th>
                                <th scope="col">Created</th>
                                <th scope="col">Updated</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for block in blocks %}
                            <tr>
                                <td>
                                    <code class="s-code">{{ block.id }}</code>
                                </td>
                                <td>
                                    <span class="s-badge s-badge__outlined">{{ block.network }}</span>
                                </td>
                                <td>
                                    {% if block.status == 'PENDING' %}
                                    <span class="s-badge s-badge__warning">Pending</span>
                                    {% elif block.status == 'IN_PROGRESS' %}
                                    <span class="s-badge s-badge__info">In Progress</span>
                                    {% else %}
                                    <span class="s-badge s-badge__outlined">{{ block.status }}</span>
                                    {% endif %}
                                </td>
                                <td>
                                    {% if block.assigned_to %}
                                    <span class="s-badge s-badge__outlined">{{ block.assigned_to }}</span>
                                    {% else %}
                                    <span class="s-text-muted">-</span>
                                    {% endif %}
                                </td>
                                <td>
                                    {% if block.last_assigned %}
                                    <time class="s-text-caption">{{ block.last_assigned }}</time>
                                    {% else %}
                                    <span class="s-text-muted">-</span>
                                    {% endif %}
                                </td>
                                <td>
                                    <time class="s-text-caption">{{ block.created_at }}</time>
                                </td>
                                <td>
                                    <time class="s-text-caption">{{ block.updated_at }}</time>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>

                <!-- Pagination -->
                {% if pagination.total_pages > 1 %}
                <div class="d-flex ai-center jc-space-between mt16">
                    <div class="s-text-caption">
                        Showing {{ (pagination.page - 1) * pagination.per_page + 1 }} to 
                        {{ pagination.page * pagination.per_page if pagination.page * pagination.per_page < pagination.total_count else pagination.total_count }} 
                        of {{ pagination.total_count }} blocks
                    </div>
                    <div class="s-pagination">
                        {% if pagination.has_prev %}
                        <a href="?page={{ pagination.prev_page }}" class="s-pagination--item">
                            <svg class="svg-icon iconArrowLeft" width="18" height="18" viewBox="0 0 18 18">
                                <path d="M5.5 4.5 10.5 9.5 5.5 14.5"></path>
                            </svg>
                        </a>
                        {% endif %}
                        
                        {% for p in range(1, pagination.total_pages + 1) %}
                            {% if p == pagination.page %}
                            <span class="s-pagination--item s-pagination--item__current">{{ p }}</span>
                            {% elif p <= 3 or p > pagination.total_pages - 3 or (p >= pagination.page - 1 and p <= pagination.page + 1) %}
                            <a href="?page={{ p }}" class="s-pagination--item">{{ p }}</a>
                            {% elif p == 4 and pagination.page > 5 %}
                            <span class="s-pagination--item s-pagination--item__clear">…</span>
                            {% elif p == pagination.total_pages - 3 and pagination.page < pagination.total_pages - 4 %}
                            <span class="s-pagination--item s-pagination--item__clear">…</span>
                            {% endif %}
                        {% endfor %}
                        
                        {% if pagination.has_next %}
                        <a href="?page={{ pagination.next_page }}" class="s-pagination--item">
                            <svg class="svg-icon iconArrowRight" width="18" height="18" viewBox="0 0 18 18">
                                <path d="M12.5 4.5 7.5 9.5 12.5 14.5"></path>
                            </svg>
                        </a>
                        {% endif %}
                    </div>
                </div>
                {% endif %}
                {% else %}
                <div class="s-empty-state">
                    <div class="s-empty-state--illustration">
                        <svg class="svg-icon iconCheckmark" width="48" height="48" viewBox="0 0 48 48">
                            <path d="M20.5 6C12.5 6 6 12.5 6 20.5S12.5 35 20.5 35c4.5 0 8.5-2 11.5-5l10 10 3-3-10-10c3-3 5-7 5-11.5C40 12.5 33.5 6 25.5 6H20.5zM20.5 9c6.5 0 11.5 5 11.5 11.5S27 32 20.5 32 9 27 9 20.5 14 9 20.5 9z"/>
                        </svg>
                    </div>
                    <h3 class="s-empty-state--title">No blocks currently processing</h3>
                    <p class="s-empty-state--description">
                        All network blocks have been completed or are in a final state.
                    </p>
                </div>
                {% endif %}
            </div>
        </div>
    </main>

    <script src="{{ url_for('static', path='/js/browser.umd.js') }}"></script>
</body>
</html>
